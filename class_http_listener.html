<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ゴミ箱: HttpListener Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ゴミ箱
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_http_listener-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">HttpListener Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a14884a7ed3660e3a653be63fd547bdc6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_http_listener.html#a14884a7ed3660e3a653be63fd547bdc6">HttpListener</a> ()=delete</td></tr>
<tr class="separator:a14884a7ed3660e3a653be63fd547bdc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac65f2b5bea42b57985c1b0886a134e6d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_http_listener.html#ac65f2b5bea42b57985c1b0886a134e6d">HttpListener</a> (tcp::acceptor &amp;acceptor, <a class="el" href="classhttp_1_1_router.html">Router</a> &amp;router)</td></tr>
<tr class="separator:ac65f2b5bea42b57985c1b0886a134e6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a4ffd7443d51450e33c27eb5472def2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_http_listener.html#a2a4ffd7443d51450e33c27eb5472def2">accept</a> ()</td></tr>
<tr class="separator:a2a4ffd7443d51450e33c27eb5472def2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab176a7fdeb5dfdd898a3d1980685ff07"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_http_listener.html#ab176a7fdeb5dfdd898a3d1980685ff07">send_response</a> ()</td></tr>
<tr class="separator:ab176a7fdeb5dfdd898a3d1980685ff07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ae31b396d36d5eb90de93746a0a9d58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_http_listener.html#a8ae31b396d36d5eb90de93746a0a9d58">prepare_response</a> ()</td></tr>
<tr class="separator:a8ae31b396d36d5eb90de93746a0a9d58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a123671735eb9cc4facb3e2d6180ad15d"><td class="memTemplParams" colspan="2">template&lt;typename Error &gt; </td></tr>
<tr class="memitem:a123671735eb9cc4facb3e2d6180ad15d"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="class_http_listener.html#a123671735eb9cc4facb3e2d6180ad15d">send_error_response</a> (Error &amp;&amp;<a class="el" href="namespaceboost_1_1beast_1_1http.html#a12540700977fe07dcb84aa3493556c81">error</a>, <a class="el" href="namespaceboost_1_1beast_1_1http.html#ac21267a10b4c07b78b2990a16857607f">http::status</a> <a class="el" href="namespaceboost_1_1beast_1_1http.html#ac21267a10b4c07b78b2990a16857607f">status</a>=http::status::internal_server_error)</td></tr>
<tr class="separator:a123671735eb9cc4facb3e2d6180ad15d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f6d127cf4df5b454cc929ad3a5e75d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_http_listener.html#a8f6d127cf4df5b454cc929ad3a5e75d2">read_request</a> ()</td></tr>
<tr class="separator:a8f6d127cf4df5b454cc929ad3a5e75d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89146fcbd476eb827acef75a702e2ae3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_http_listener.html#a89146fcbd476eb827acef75a702e2ae3">handle_request</a> ()</td></tr>
<tr class="separator:a89146fcbd476eb827acef75a702e2ae3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>HTTP boost::io_service handler.</p>
<p>Object of this class should live as long as boost::io_service::run() is executing. It can be achieved through different means:</p><ul>
<li>Use shared_ptr to control lifetime and refer to itself from each async closure.</li>
<li>Just create object on stack and let it live long enough (Maybe a bad idea to put it in heap in multithreaded environment).</li>
</ul>
<p>First can case can be found in multiple examples. But the second works as charm even in multithreaded environment. So why settle for unnecessary overhead of shared_ptr?</p>
<p>TODO: There is a question whether you'd need a synchronization for pure heap-allocated members. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a14884a7ed3660e3a653be63fd547bdc6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">HttpListener::HttpListener </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac65f2b5bea42b57985c1b0886a134e6d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">HttpListener::HttpListener </td>
          <td>(</td>
          <td class="paramtype">tcp::acceptor &amp;&#160;</td>
          <td class="paramname"><em>acceptor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classhttp_1_1_router.html">Router</a> &amp;&#160;</td>
          <td class="paramname"><em>router</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a2a4ffd7443d51450e33c27eb5472def2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void HttpListener::accept </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Handle new incoming connection.</p>
<p>After finishing handling each new connection the function is called once again. The function should be called only after request's handling is finished! As long as it is called there will be jobs to do for boost::io_service and it will loop through them forever. </p>

</div>
</div>
<a class="anchor" id="a89146fcbd476eb827acef75a702e2ae3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void HttpListener::handle_request </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Handles HTTP Request.</p>
<p>TODO: Next step is to think of API to provide routing. </p>

</div>
</div>
<a class="anchor" id="a8ae31b396d36d5eb90de93746a0a9d58"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void HttpListener::prepare_response </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Finalize response by setting default headers. </p>

</div>
</div>
<a class="anchor" id="a8f6d127cf4df5b454cc929ad3a5e75d2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void HttpListener::read_request </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Reads Client's request</p>
<p>On failure to read it would make sense to send back some meaningful error response. </p>

</div>
</div>
<a class="anchor" id="a123671735eb9cc4facb3e2d6180ad15d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Error &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void HttpListener::send_error_response </td>
          <td>(</td>
          <td class="paramtype">Error &amp;&amp;&#160;</td>
          <td class="paramname"><em>error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceboost_1_1beast_1_1http.html#ac21267a10b4c07b78b2990a16857607f">http::status</a>&#160;</td>
          <td class="paramname"><em>status</em> = <code>http::status::internal_server_error</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sends response with error to client.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">error</td><td>Error type. It is inserted into response using stream operator. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">status</td><td>HTTP Status code. Default is 500. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab176a7fdeb5dfdd898a3d1980685ff07"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void HttpListener::send_response </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sends response back to client.</p>
<p>Closes socket and accepts another connection. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/http/<a class="el" href="server_8cpp.html">server.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
